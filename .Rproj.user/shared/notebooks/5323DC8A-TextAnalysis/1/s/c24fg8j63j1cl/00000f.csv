"0","#Run model on training data (slow) for clusterX"
"0",""
"0","is_cluster <- data_joined$cluster1 == 1 #<--- change clusterX to whatever cluster you want to plot"
"0",""
"0","model <- cv.glmnet(sparse_words, is_cluster,"
"0","                   family = ""binomial"", intercept = TRUE"
"0","                   #parallel = TRUE, keep = TRUE"
"0",")"
"0",""
"0","#Pull out coefficients"
"0","coefs <- model$glmnet.fit %>%"
"0","  tidy() %>%"
"0","  filter(lambda == model$lambda.min)"
"0",""
"0","#Plot coefficients "
"0","coefs %>%"
"0","  group_by(estimate > 0) %>%"
"0","  top_n(15, abs(estimate)) %>%"
"0","  ungroup() %>%"
"0","  ggplot(aes(fct_reorder(term, estimate), estimate, fill = estimate > 0)) +"
"0","  geom_col(alpha = 0.8, show.legend = FALSE) +"
"0","  coord_flip() + theme(axis.text=element_text(size=11)) +"
"0","  labs("
"0","    x = NULL,"
"0","    title = ""15 largest/smallest coefficients"")"
