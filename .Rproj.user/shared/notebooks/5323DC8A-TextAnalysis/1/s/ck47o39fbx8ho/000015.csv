"0",""
"0","#Make binomial variables for each cluster (could be put in an elegant loop but...)"
"0",""
"0","zillow<-st_drop_geometry(zillow)"
"0",""
"0","zillow$cluster1[zillow$cluster4!=1] <- 0    "
"0","zillow$cluster1[zillow$cluster4==1] <- 1    "
"0","words$cluster1[words$cluster4!=1] <- 0    "
"0","words$cluster1[words$cluster4==1] <- 1"
"0","zillow$cluster2[zillow$cluster4!=2] <- 0    "
"0","zillow$cluster2[zillow$cluster4==2] <- 1    "
"0","words$cluster2[words$cluster4!=2] <- 0    "
"0","words$cluster2[words$cluster4==2] <- 1"
"0","zillow$cluster3[zillow$cluster4!=3] <- 0    "
"0","zillow$cluster3[zillow$cluster4==3] <- 1    "
"0","words$cluster3[words$cluster4!=3] <- 0    "
"0","words$cluster3[words$cluster4==3] <- 1"
"0","zillow$cluster4[zillow$cluster4!=4] <- 0    "
"0","zillow$cluster4[zillow$cluster4==4] <- 1    "
"0","words$cluster4[words$cluster4!=4] <- 0    "
"0","words$cluster4[words$cluster4==4] <- 1"
"0",""
"0","#Remove words that only occurs less than 5 times"
"0","words$nn <- ave(words$word,words$word, FUN=length)"
"0","words$nn <- as.numeric(words$nn)"
"0","words<- words[ -which( words$nn <5), ]"
"0",""
"0","##split into testing and training dataset"
"0",""
"0","data_split<- zillow%>%select(USER_ID)"
"0","data_split<- initial_split(data_split)"
"0","train_data <- training(data_split)"
"0","test_data <- testing(data_split)"
"0",""
"0","#transform training data from tidy data structure to a sparse matrix"
"0","sparse_words <- words %>%"
"0","  count(USER_ID, word) %>%"
"0","  inner_join(train_data) %>%"
"0","  cast_sparse(USER_ID, word, n)"
"2","Joining, by = ""USER_ID"""
"2","Error in (function (cl, name, valueClass)  : 
  assignment of an object of class “numeric” is not valid for @‘Dim’ in an object of class “dgTMatrix”; is(value, ""integer"") is not TRUE
"
